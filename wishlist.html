<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="å‘¨é‡‘éœç”·å‹">
    <title>æ„¿æœ›æ¸…å• - å°å‘¨çš„ç”·å‹å…»æˆè®¡åˆ’ â¤ï¸</title>
    <script src="https://cdn.jsdelivr.net/npm/leancloud-storage@4.15.0/dist/av-min.js"></script>
    <link rel="stylesheet" href="common.css">
</head>
<body>
<div class="bg-shape shape-1"></div>
<div class="bg-shape shape-2"></div>
<div id="sakura-container"></div>

<div class="container">
    <header>
        <h1>âœ¨ æ„¿æœ›æ¸…å• <span class="version-tag">V3.5</span></h1>
        <div class="love-days">å·²ç»è®¤è¯† <span id="days-count">0</span> å¤©å•¦ ğŸ’•</div>
    </header>

    <div class="nav-tabs">
        <a href="index.html" class="nav-btn">ğŸ  ä¸»é¡µ</a>
        <a href="wishlist.html" class="nav-btn active">âœ¨ æ„¿æœ›</a>
        <a href="album.html" class="nav-btn">ğŸ–¼ï¸ ç›¸å†Œ</a>
        <a href="shop.html" class="nav-btn">ğŸ å•†åº—</a>
        <a href="games.html" class="nav-btn">ğŸ® æ¸¸æˆ</a>
        <a href="plan.html" class="nav-btn">ğŸ“‹ è®¡åˆ’</a>
        <a href="settings.html" class="nav-btn">âš™ï¸ è®¾ç½®</a>
    </div>

    <div class="progress-card">
        <div class="progress-info">
            <span>â¤ï¸ æ‹çˆ±æˆå°±è¿›åº¦</span>
            <span id="wish-count">0/0</span>
        </div>
        <div class="progress-bar-bg">
            <div class="progress-bar-fill" id="wish-progress" style="width: 0%"></div>
        </div>
    </div>

    <div class="category-selector" id="category-selector">
        <button class="cat-btn active" onclick="app.selectCat('ğŸ’–')" data-cat="ğŸ’–">ğŸ’–</button>
        <button class="cat-btn" onclick="app.selectCat('ğŸ±')" data-cat="ğŸ±">ğŸ±</button>
        <button class="cat-btn" onclick="app.selectCat('âœˆï¸')" data-cat="âœˆï¸">âœˆï¸</button>
        <button class="cat-btn" onclick="app.selectCat('ğŸ¬')" data-cat="ğŸ¬">ğŸ¬</button>
        <button class="cat-btn" onclick="app.selectCat('ğŸ¤')" data-cat="ğŸ¤">ğŸ¤</button>
        <button class="cat-btn" onclick="app.selectCat('ğŸ')" data-cat="ğŸ">ğŸ</button>
    </div>
    <div style="display:flex; gap:10px; margin-bottom:20px;">
        <input type="text" id="wish-input" placeholder="ğŸ’¡ å†™ä¸‹æƒ³ä¸€èµ·åšçš„äº‹..." style="margin-bottom:0; flex:1;">
        <button class="btn" style="width:60px; padding:0; background:var(--accent-pink); color:white;" onclick="app.addWish()">+</button>
    </div>

    <div id="wish-list" class="wish-list-container"></div>
</div>

<script src="js/core/sound-manager.js"></script>
<script src="js/core/storage.js"></script>
<script src="js/core/utils.js"></script>
<script src="js/core/constants.js"></script>
<script src="js/ui/ui-manager.js"></script>
<script src="common.js"></script>
<script>
Object.assign(app, {
    init() {
        this.initCommon();
        this.render();
    },

    render() {
        const wishList = document.getElementById('wish-list');
        if (!wishList) return;
        
        if (this.data.wishes.length === 0) {
            wishList.innerHTML = '<div class="empty-wish">è¿˜æ²¡æœ‰æ„¿æœ›å“¦ï¼Œå¿«æ·»åŠ ç¬¬ä¸€ä¸ªå¿ƒæ„¿å§ï¼âœ¨</div>';
        } else {
            wishList.innerHTML = this.data.wishes.map(w => `
                <div class="wish-item ${w.done ? 'wish-done' : ''}">
                    <div class="wish-content" onclick="app.toggleWish(${w.id})">
                        <div class="wish-checkbox ${w.done ? 'checked' : ''}"></div>
                        <div class="wish-icon">${w.icon || 'ğŸ’–'}</div>
                        <span class="wish-text">${w.text}</span>
                    </div>
                    <button class="btn-del-wish" onclick="app.deleteWish(${w.id})">ğŸ—‘ï¸</button>
                </div>
            `).join('');
        }

        const total = this.data.wishes.length;
        const done = this.data.wishes.filter(w => w.done).length;
        const percent = total === 0 ? 0 : Math.round((done / total) * 100);
        
        const countEl = document.getElementById('wish-count');
        const progressEl = document.getElementById('wish-progress');
        if (countEl) countEl.innerText = `${done}/${total}`;
        if (progressEl) progressEl.style.width = `${percent}%`;
    },

    selectCat(icon) {
        this.currentCat = icon;
        document.querySelectorAll('.cat-btn').forEach(btn => {
            btn.classList.remove('active');
            if(btn.dataset.cat === icon) btn.classList.add('active');
        });
    },

    addWish() {
        const input = document.getElementById('wish-input');
        const text = input.value.trim();
        if(!text) return alert('æ„¿æœ›å†…å®¹ä¸èƒ½ä¸ºç©ºå“¦ï¼ğŸ’¡');
        
        this.data.wishes.unshift({
            id: Date.now(),
            text: text,
            icon: this.currentCat,
            done: false
        });
        input.value = '';
        this.saveData();
        this.showToast('æ„¿æœ›å·²æ·»åŠ ï¼ä¸€èµ·åŠªåŠ›å®ç°å§ï¼âœ¨');
    },

    toggleWish(id) {
        const wish = this.data.wishes.find(w => w.id === id);
        if(wish) {
            wish.done = !wish.done;
            this.saveData();
            if(wish.done) {
                createPetal(); createPetal(); createPetal();
                this.showToast('å¤ªæ£’äº†ï¼åˆå®Œæˆäº†ä¸€ä¸ªå¿ƒæ„¿ï¼ğŸ‰');
            }
        }
    },

    deleteWish(id) {
        if(confirm('ç¡®å®šè¦åˆ é™¤è¿™ä¸ªæ„¿æœ›å—ï¼Ÿ')) {
            this.data.wishes = this.data.wishes.filter(w => w.id !== id);
            this.saveData();
        }
    }
});

app.init();
</script>
</body>
</html>

